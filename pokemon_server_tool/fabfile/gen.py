#!/usr/bin/python
# -*- coding: utf-8 -*-

# game-1
CMGO_GAME_1 = "mongodb://gamesystem:123456@172.16.2.10:27017"
# game-2
CMGO_GAME_2 = "mongodb://gamesystem:123456@172.16.2.28:27017"
# game-3
CMGO_GAME_3 = "mongodb://gamesystem:123456@172.16.2.3:27017"
# game-4
CMGO_GAME_4 = "mongodb://gamesystem:123456@172.16.2.35:27017"

# game-qd-1
CMGO_GAME_QD_1 = "mongodb://gamesystem:123456@172.16.2.47:27017"
# game-qd-2
CMGO_GAME_QD_2 = "mongodb://gamesystem:123456@172.16.2.43:27017"
# game-qd-3
CMGO_GAME_QD_3 = "mongodb://gamesystem:123456@172.16.2.18:27017"
# game-qd-4
CMGO_GAME_QD_4 = "mongodb://gamesystem:123456@172.16.2.49:27017"
# game-qd-5
CMGO_GAME_QD_5 = "mongodb://gamesystem:123456@172.16.2.22:27017"
# game-qd-6
CMGO_GAME_QD_6 = "mongodb://gamesystem:1234560@172.16.2.140:27017"
# game-qd-7
CMGO_GAME_QD_7 = "mongodb://gamesystem:123456@172.16.2.63:27017"
# game-qd-8
CMGO_GAME_QD_8 = "mongodb://gamesystem:123456@172.16.2.89:27017"
# game-qd-9
CMGO_GAME_QD_9 = "mongodb://gamesystem:123456@172.16.2.69:27017"
# game-qd-10
CMGO_GAME_QD_10 = "mongodb://gamesystem:123456@172.16.2.81:27017"
# game-qd-11
CMGO_GAME_QD_11 = "mongodb://gamesystem:123456@172.16.2.75:27017"
# game-qd-12
CMGO_GAME_QD_12 = "mongodb://gamesystem:123456@172.16.2.125:27017"
# game-qd-13
CMGO_GAME_QD_13 = "mongodb://gamesystem:123456@172.16.2.122:27017"
# game-qd-14
CMGO_GAME_QD_14 = "mongodb://gamesystem:123456@172.16.2.138:27017"

MGOIDMap = {
	'cn_01': CMGO_GAME_1,
	'cn_02': CMGO_GAME_1,
	'cn_03': CMGO_GAME_1,
	'cn_04': CMGO_GAME_1,
	'cn_05': CMGO_GAME_1,
	'cn_06': CMGO_GAME_1,
	'cn_07': CMGO_GAME_1,
	'cn_08': CMGO_GAME_1,
	'cn_09': CMGO_GAME_1,
	'cn_10': CMGO_GAME_1,
	'cn_11': CMGO_GAME_1,
	'cn_12': CMGO_GAME_1,
	'cn_13': CMGO_GAME_1,
	'cn_14': CMGO_GAME_1,

	'cn_15': CMGO_GAME_2,
	'cn_16': CMGO_GAME_2,
	'cn_17': CMGO_GAME_2,
	'cn_18': CMGO_GAME_2,
	'cn_19': CMGO_GAME_2,
	'cn_20': CMGO_GAME_2,
	'cn_21': CMGO_GAME_2,
	'cn_22': CMGO_GAME_2,
	'cn_23': CMGO_GAME_2,
	'cn_24': CMGO_GAME_2,
	'cn_25': CMGO_GAME_2,
	'cn_26': CMGO_GAME_2,
	'cn_27': CMGO_GAME_2,
	'cn_28': CMGO_GAME_2,
	'cn_29': CMGO_GAME_2,
	'cn_30': CMGO_GAME_2,
	'cn_31': CMGO_GAME_2,
	'cn_32': CMGO_GAME_2,
	'cn_33': CMGO_GAME_2,

	'cn_34': CMGO_GAME_3,
	'cn_35': CMGO_GAME_3,
	'cn_36': CMGO_GAME_3,
	'cn_37': CMGO_GAME_3,
	'cn_38': CMGO_GAME_3,
	'cn_39': CMGO_GAME_3,
	'cn_40': CMGO_GAME_3,
	'cn_41': CMGO_GAME_3,
	'cn_42': CMGO_GAME_3,
	'cn_43': CMGO_GAME_3,
	'cn_44': CMGO_GAME_3,
	'cn_45': CMGO_GAME_3,
	'cn_46': CMGO_GAME_3,
	'cn_47': CMGO_GAME_3,
	'cn_48': CMGO_GAME_3,
	'cn_49': CMGO_GAME_3,
	'cn_50': CMGO_GAME_3,
	'cn_51': CMGO_GAME_3,
	'cn_52': CMGO_GAME_3,
	'cn_53': CMGO_GAME_3,
	'cn_54': CMGO_GAME_3,
	'cn_55': CMGO_GAME_3,
	'cn_56': CMGO_GAME_3,
	'cn_57': CMGO_GAME_3,
	'cn_58': CMGO_GAME_3,
	'cn_59': CMGO_GAME_3,
	'cn_60': CMGO_GAME_3,
	'cn_61': CMGO_GAME_3,

	'cn_qd_01': CMGO_GAME_QD_1,
	'cn_qd_02': CMGO_GAME_QD_1,
	'cn_qd_03': CMGO_GAME_QD_1,
	'cn_qd_04': CMGO_GAME_QD_1,
	'cn_qd_05': CMGO_GAME_QD_1,
	'cn_qd_06': CMGO_GAME_QD_1,
	'cn_qd_07': CMGO_GAME_QD_1,
	'cn_qd_08': CMGO_GAME_QD_1,
	'cn_qd_09': CMGO_GAME_QD_1,
	'cn_qd_10': CMGO_GAME_QD_1,
	'cn_qd_11': CMGO_GAME_QD_1,
	'cn_qd_12': CMGO_GAME_QD_1,
	'cn_qd_13': CMGO_GAME_QD_1,
	'cn_qd_14': CMGO_GAME_QD_1,
	'cn_qd_15': CMGO_GAME_QD_1,
	'cn_qd_16': CMGO_GAME_QD_1,
	'cn_qd_17': CMGO_GAME_QD_1,
	'cn_qd_18': CMGO_GAME_QD_1,
	'cn_qd_19': CMGO_GAME_QD_1,
	'cn_qd_20': CMGO_GAME_QD_1,
	'cn_qd_21': CMGO_GAME_QD_1,
	'cn_qd_22': CMGO_GAME_QD_1,
	'cn_qd_23': CMGO_GAME_QD_1,
	'cn_qd_24': CMGO_GAME_QD_1,
	'cn_qd_25': CMGO_GAME_QD_1,
	'cn_qd_26': CMGO_GAME_QD_1,
	'cn_qd_27': CMGO_GAME_QD_1,
	'cn_qd_28': CMGO_GAME_QD_1,
	'cn_qd_29': CMGO_GAME_QD_1,
	'cn_qd_30': CMGO_GAME_QD_1,

	'cn_qd_31': CMGO_GAME_QD_2,
	'cn_qd_32': CMGO_GAME_QD_2,
	'cn_qd_33': CMGO_GAME_QD_2,
	'cn_qd_34': CMGO_GAME_QD_2,
	'cn_qd_35': CMGO_GAME_QD_2,
	'cn_qd_36': CMGO_GAME_QD_2,
	'cn_qd_37': CMGO_GAME_QD_2,
	'cn_qd_38': CMGO_GAME_QD_2,
	'cn_qd_39': CMGO_GAME_QD_2,
	'cn_qd_40': CMGO_GAME_QD_2,
	'cn_qd_41': CMGO_GAME_QD_2,
	'cn_qd_42': CMGO_GAME_QD_2,
	'cn_qd_43': CMGO_GAME_QD_2,
	'cn_qd_44': CMGO_GAME_QD_2,
	'cn_qd_45': CMGO_GAME_QD_2,
	'cn_qd_46': CMGO_GAME_QD_2,
	'cn_qd_47': CMGO_GAME_QD_2,
	'cn_qd_48': CMGO_GAME_QD_2,
	'cn_qd_49': CMGO_GAME_QD_2,
	'cn_qd_50': CMGO_GAME_QD_2,
	'cn_qd_51': CMGO_GAME_QD_2,
	'cn_qd_52': CMGO_GAME_QD_2,
	'cn_qd_53': CMGO_GAME_QD_2,
	'cn_qd_54': CMGO_GAME_QD_2,
	'cn_qd_55': CMGO_GAME_QD_2,
	'cn_qd_56': CMGO_GAME_QD_2,
	'cn_qd_57': CMGO_GAME_QD_2,
	'cn_qd_58': CMGO_GAME_QD_2,
	'cn_qd_59': CMGO_GAME_QD_2,
	'cn_qd_60': CMGO_GAME_QD_2,

	'cn_qd_61': CMGO_GAME_QD_3,
	'cn_qd_62': CMGO_GAME_QD_3,
	'cn_qd_63': CMGO_GAME_QD_3,
	'cn_qd_64': CMGO_GAME_QD_3,
	'cn_qd_65': CMGO_GAME_QD_3,
	'cn_qd_66': CMGO_GAME_QD_3,
	'cn_qd_67': CMGO_GAME_QD_3,
	'cn_qd_68': CMGO_GAME_QD_3,
	'cn_qd_69': CMGO_GAME_QD_3,
	'cn_qd_70': CMGO_GAME_QD_3,
	'cn_qd_71': CMGO_GAME_QD_3,
	'cn_qd_72': CMGO_GAME_QD_3,
	'cn_qd_73': CMGO_GAME_QD_3,
	'cn_qd_74': CMGO_GAME_QD_3,
	'cn_qd_75': CMGO_GAME_QD_3,
	'cn_qd_76': CMGO_GAME_QD_3,
	'cn_qd_77': CMGO_GAME_QD_3,
	'cn_qd_78': CMGO_GAME_QD_3,
	'cn_qd_79': CMGO_GAME_QD_3,
	'cn_qd_80': CMGO_GAME_QD_3,
	'cn_qd_81': CMGO_GAME_QD_3,
	'cn_qd_82': CMGO_GAME_QD_3,
	'cn_qd_83': CMGO_GAME_QD_3,
	'cn_qd_84': CMGO_GAME_QD_3,
	'cn_qd_85': CMGO_GAME_QD_3,
	'cn_qd_86': CMGO_GAME_QD_3,
	'cn_qd_87': CMGO_GAME_QD_3,
	'cn_qd_88': CMGO_GAME_QD_3,
	'cn_qd_89': CMGO_GAME_QD_3,
	'cn_qd_90': CMGO_GAME_QD_3,
}

CN_NSQLOOK_UPD = "http://172.16.2.14:4161/"
CN_MAINNSQD = "172.16.2.14:4150"

DEV_NSQLOOK_UPD = "http://192.168.1.125:4161/"
DEV_MAINNSQD = "192.168.1.125:4150"

STORAGE_TEMPLATE = """<
	"storage.{tag}.{id}": <
        "nsqlookupd": "{nsqlookupd}",
        "mainnsqd": "{mainnsqd}",
        "services": [
            <
                "name": "storage.{tag}.{id}",
                "mongodb": "{mongodb}",
                "dbname": "{dbname}"
            >
        ]
    >
>"""

PVP_TEMPLATE = """<
	"pvp.{tag}.{id}": <
		"nsqlookupd": "{nsqlookupd}",
		"mainnsqd": "{mainnsqd}",
		"services": [
			<
				"name": "arena.{tag}.{id}",
				"dependent": [
					"storage.{tag}.{id}"
				]
			>,
			<
				"name": "union.{tag}.{id}",
				"dependent": [
					"storage.{tag}.{id}"
				]
			>,
			<
				"name": "union_fight.{tag}.{id}",
				"dependent": [
					"anticheat",
					"storage.{tag}.{id}",
					"game.{tag}.{id}"
				]
			>,
			<
				"name": "craft.{tag}.{id}",
				"dependent": [
					"anticheat",
					"storage.{tag}.{id}",
					"game.{tag}.{id}"
				]
			>,
			<
				"name": "clone.{tag}.{id}",
				"dependent": [
					"storage.{tag}.{id}"
				]
			>
		]
	>
>"""

def gen_pvp_define(key):
	game_key, tag, id = key.split('.')
	lang = tag.split('_')[0]

	if lang == "cn":
		nsqlookupd, mainnsqd = CN_NSQLOOK_UPD, CN_MAINNSQD
	elif lang == "dev":
		nsqlookupd, mainnsqd = DEV_NSQLOOK_UPD, DEV_MAINNSQD
	else:
		raise Exception('pvp %s error' % key)

	return PVP_TEMPLATE.format(tag=tag, id=id, nsqlookupd=nsqlookupd, mainnsqd=mainnsqd).replace('<', '{').replace('>', '}')

def gen_storage_define(key):
	game_key, tag, id = key.split('.')
	lang = tag.split('_')[0]

	if lang == "cn":
		nsqlookupd, mainnsqd = CN_NSQLOOK_UPD, CN_MAINNSQD
		dbname = "%s_%s_%s"% (game_key, tag, id)
		url = MGOIDMap['%s_%02d' % tag, int(id)]
		mongodb = "%s/%s?authMechanism=SCRAM-SHA-1&authSource=admin" % (url, dbname)
	elif lang == "dev":
		nsqlookupd, mainnsqd = DEV_NSQLOOK_UPD, DEV_MAINNSQD
		dbname = "%s_%s%s"% (game_key, tag, id)
		mongodb = "192.168.1.96:27018"
	else:
		raise Exception('storage %s error' % key)

	return STORAGE_TEMPLATE.format(game_key=game_key, tag=tag, id=id, nsqlookupd=nsqlookupd, mainnsqd=mainnsqd, mongodb=mongodb, dbname=dbname).replace('<', '{').replace('>', '}')
